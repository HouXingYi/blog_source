
# 搭建Node.js线上环境

首先购买域名与服务器，这方面每个人都不同就不说了。

## 整体思路

从2-6从一个故事理解整个部署思路来理解。

https://coding.imooc.com/lesson/95.html#mid=3093

## 远程登录服务器

就我来说，我购买阿里云的域名与服务器。配置为1核1GB内存，操作系统为Ubuntu 14.04 64位。

应用可以放在系统盘或者数据盘，若放在系统盘，则重装系统，数据与应用就没有了。

`fdisk -l`查看硬盘 `df -h`查看硬盘使用情况（是否满，经常用）

### 配置root权限与账号

`adduser`添加新用户 

SSH无密码登录：给服务器操作系统放上我们主机的公匙


## 增强服务器安全等级

**修改服务器默认登录端口**

通过修改默认登录端口，禁止root登录等来提高安全

**配置iptables和Fail2Ban**

跳过

## 配置Nginx实现反向代理

不是root权限无法启动80端口（默认端口），所以我们引入Nginx实现服务的代理，把80端口的请求转发到其他端口。


## 配置Nginx实现反向代理

主要是配置Nginx

## 利用 DNSPod 管理域名解析

可以利用DNSPod管理所有的域名，先跳过。

## 服务器配置并安装mongoDB

一般来说数据库和应用的服务器是分开的，我们现在限于成本就放在一台中。

https://docs.mongodb.com/manual/tutorial/install-mongodb-on-ubuntu/

根据上面的步骤一步一步做。

在conf中将端口改为19999 ，使用的时候 `mongo --port 19999`

**mongoDB导入数据**

`mongodump -h 127.0.0.1:27017 -d 需要导出的名字 -o 导出到哪`

跳过，到后面具体操作数据的时候再说

## 向服务器正式部署和发布上线Nodejs项目

利用git来更新服务器上的代码，把服务器上的公匙给github就可以了。


### dns解析，二级域名

blog.houxingyi.site

### pm2自动部署发布
利用pm2进行自动部署上线

### 数据库部署

需要配置数据库密码等，那节跳过了，后面再说。
























































